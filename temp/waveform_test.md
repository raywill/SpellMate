# 实时波形可视化功能测试

## 功能说明
在录音过程中，页面会显示一个实时音频波形可视化区域：
- **有声音时**: 绿色波形线上下跳动
- **静音时**: 波形接近平直的中线（灰色参考线）
- **背景**: 深色渐变背景（从 #1f2937 到 #111827）

## 测试步骤

### 1. 基础波形显示测试
1. 打开 index.html
2. 点击"开始录制"
3. **检查点**: 应该出现一个深色背景的波形区域，标题为"🎵 实时音频波形"
4. 点击"结束录制"
5. **检查点**: 波形区域应该消失

### 2. 有声音时的波形测试
1. 点击"开始录制"
2. 对着麦克风说"你好"
3. **检查点**: 
   - 绿色波形线应该明显跳动
   - 跳动幅度随声音大小变化
   - 波形实时响应，延迟小于100ms

### 3. 静音时的波形测试
1. 点击"开始录制"
2. 保持完全安静5秒
3. **检查点**:
   - 波形应该接近平直的中线
   - 可能有轻微波动（白噪声），但幅度很小
   - 中线（灰色参考线）清晰可见

### 4. 声音和静音交替测试
1. 点击"开始录制"
2. 说"你好" → 停顿2秒 → 说"世界" → 停顿2秒 → 说"再见"
3. **检查点**:
   - 说话时波形跳动
   - 停顿时波形平直
   - 转换流畅，无卡顿

### 5. 不同音量测试
1. 点击"开始录制"
2. 小声说话
3. 正常音量说话
4. 大声说话
5. **检查点**:
   - 小声时波形跳动幅度小
   - 大声时波形跳动幅度大
   - 波形幅度与音量成正比

### 6. 白噪声容忍测试
1. 在有轻微背景噪音的环境中（如空调、电脑风扇）
2. 点击"开始录制"
3. 保持安静
4. **检查点**:
   - 背景噪音应该只产生很小的波动
   - 说话时的波形明显大于噪音波形
   - 可以清晰区分有效语音和背景噪音

## 预期结果总结

| 状态 | 波形表现 |
|------|---------|
| 录音前 | 不显示波形区域 |
| 开始录音 | 波形区域出现 |
| 有声音输入 | 绿色波形明显跳动 |
| 静音 | 波形接近平直中线 |
| 背景噪音 | 轻微波动 |
| 结束录音 | 波形区域消失 |

## 技术细节

- **FFT大小**: 2048
- **刷新率**: 60fps（requestAnimationFrame）
- **波形颜色**: rgb(16, 185, 129) - 绿色
- **背景颜色**: rgb(17, 24, 39) - 深灰色
- **中线颜色**: rgba(107, 114, 128, 0.3) - 半透明灰色
- **Canvas高度**: 100px
- **Canvas宽度**: 容器宽度减去40px padding

## 已知限制

1. 首次授权麦克风权限可能需要刷新页面
2. 某些浏览器可能需要HTTPS环境才能使用麦克风
3. 波形显示基于时域数据，不是频域数据

## 测试环境

- 浏览器: Chrome 60+, Firefox 55+, Safari 14.1+, Edge 79+
- 操作系统: macOS, Windows, Linux
- 音频输入: 内置麦克风或外接麦克风

