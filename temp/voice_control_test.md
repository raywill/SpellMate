# 语音听写助手 - 测试用例

## 新功能说明

### 1. 语音控制
使用浏览器 SpeechRecognition API 来控制播放，无需手动点击

### 2. 连播两次
每次播放片段时，会自动连续播放两次，中间停顿0.3秒

### 3. 智能追踪
- 记录最后一次手动点击的片段
- 语音命令"下一个"会从最后点击的位置继续
- 支持前进、后退、重播

## 测试用例

### 测试用例 1: 基础语音识别
**步骤:**
1. 录制并生成片段
2. 点击"开启语音控制"
3. 观察"正在监听..."状态

**预期结果:**
- 语音控制区域显示绿色边框
- 状态指示器显示绿色脉动圆点
- 按钮文字变为"关闭语音控制"

### 测试用例 2: 连播两次功能
**步骤:**
1. 手动点击任意片段的"播放"按钮
2. 观察播放过程

**预期结果:**
- 片段播放一次
- 停顿0.3秒
- 自动再播放一次
- 播放完成后进度条重置
- 当前播放的片段有蓝色背景高亮

### 测试用例 3: 语音命令 - 下一个
**步骤:**
1. 开启语音控制
2. 说"下一个"或"好的"或"写好了"
3. 观察播放情况

**预期结果:**
- 识别文字显示在语音控制区域
- 播放下一个片段（连播两次）
- 当前片段蓝色高亮
- 播放完成后高亮消失

### 测试用例 4: 语音命令 - 重播
**步骤:**
1. 播放一个片段
2. 说"重播"或"再说一遍"或"什么"
3. 观察播放情况

**预期结果:**
- 当前片段重新播放（连播两次）
- 如果没有当前片段，播放第一个

### 测试用例 5: 语音命令 - 上一个
**步骤:**
1. 播放第3个片段
2. 说"上一个"或"回退"
3. 观察播放情况

**预期结果:**
- 播放第2个片段（连播两次）
- 如果已经是第一个，播放提示音（440Hz正弦波）

### 测试用例 6: 手动点击后的语音控制
**步骤:**
1. 手动点击第5个片段
2. 等待播放完成
3. 说"下一个"

**预期结果:**
- 播放第6个片段（从手动点击的位置继续）
- 不是从第1个或上次语音命令的位置开始

### 测试用例 7: 播放到最后
**步骤:**
1. 播放最后一个片段
2. 说"下一个"

**预期结果:**
- 播放提示音（440Hz，0.3秒）
- 不播放任何片段
- 索引重置

### 测试用例 8: 多种语音命令
**步骤:**
1. 依次测试以下命令：
   - "好的" → 下一个
   - "写好了" → 下一个
   - "继续" → 下一个
   - "对了" → 下一个
   - "没听清" → 重播
   - "听不清" → 重播
   - "返回" → 上一个

**预期结果:**
- 所有命令都能正确识别和执行
- 识别文字实时显示

### 测试用例 9: 连续语音命令
**步骤:**
1. 开启语音控制
2. 连续说："下一个" → "下一个" → "重播" → "上一个"

**预期结果:**
- 每个命令都能被识别
- 按顺序执行播放操作
- 不会出现命令丢失或重复

### 测试用例 10: 播放中的语音命令
**步骤:**
1. 播放一个片段
2. 在播放过程中说"下一个"

**预期结果:**
- 等待当前播放完成（连播两次都完成）
- 或者忽略命令（因为正在播放）

## 支持的语音命令列表

### 播放下一个
- 下一个
- 下一题
- 好的
- 写好了
- 继续
- 下一句
- 对了
- 好了
- 完成
- 知道了

### 重新播放当前
- 重播
- 再说一遍
- 再来一次
- 什么
- 没听清
- 再听
- 听不清
- 重复
- 重来

### 播放上一个
- 上一个
- 上一题
- 回退
- 返回
- 上一句
- 前一个

## 使用场景

### 场景1: 妈妈预先录制听写内容
1. 妈妈打开网页，点击"开始录制"
2. 说："苹果" [停顿1秒] "香蕉" [停顿1秒] "橘子" [停顿1秒] "西瓜"
3. 点击"结束录制"
4. 系统自动分割成4个片段

### 场景2: 孩子使用语音控制听写
1. 孩子打开同一页面（片段已加载）
2. 点击"开启语音控制"
3. 说"下一个" → 听到"苹果"（连播两次）
4. 写下"苹果"
5. 说"好的" → 听到"香蕉"（连播两次）
6. 写下"香蕉"
7. 说"什么" → 重新听到"香蕉"（连播两次）
8. 说"写好了" → 听到"橘子"（连播两次）
9. 继续完成剩余听写

### 场景3: 灵活控制
1. 如果某个词没听清，说"再说一遍"
2. 如果想回顾上一个词，说"上一个"
3. 如果手动点击了某个片段，下次说"下一个"会从那里继续

## 已知限制

1. **浏览器支持**: 需要支持 SpeechRecognition API 的浏览器（Chrome、Edge、Safari 14.1+）
2. **语言**: 目前只支持中文识别（zh-CN）
3. **网络**: 某些浏览器的语音识别需要网络连接
4. **权限**: 需要麦克风权限
5. **播放中断**: 播放过程中发出的语音命令可能被忽略

## 测试环境

- 浏览器: Chrome 90+（推荐）
- 操作系统: macOS, Windows, ChromeOS
- 麦克风: 内置或外接麦克风
- 网络: 建议有网络连接（用于语音识别）

## 改进建议

1. 添加离线语音识别支持
2. 支持更多语言
3. 添加语音命令自定义功能
4. 添加播放速度控制
5. 支持批量导入音频文件
6. 添加历史记录保存功能

